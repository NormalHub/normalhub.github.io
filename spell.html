<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>默写</title>
  <link rel="icon" href="./imgs/xie.png">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0, user-scalable=0">
  <style>
    html,body{
      width: 100%;
      height: 100%;
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    #unit{
      width: 100%;
      height: 100%;
      background: #f6f6f6;
      position: fixed;
      z-index: 10;
    }
    #unit p{
      text-align: center;
      padding: 20px;
      line-height: 5px;
      background: #fff;
    }
    #progress{
      width: 100%;
      background: #f6f6f6;
      position: fixed;
      top: 0;
    }
    #progressInner{
      width: 0;
      background: #27bae7;
      text-align: center;
      color: #fff;
    }
    #meaning{
      font-size: 25px;
    }
    #word{
      border: 0;
      border-bottom: 2px solid #000;
      font-size: 25px;
      text-align: center;
      margin-bottom: 20px;
      line-height: 40px;
    }
    #word:focus{outline: 0;}
    #next{
      width: 100%;
      height: 100%;
      position: fixed;
    }
    #isTrue{
      width: 60px;
      line-height: 60px;
      border: #000 solid 2px;
      border-radius: 50%;
      font-size: 30px;
      text-align: center;
      position: absolute;
      right: calc(50% - 260px);
      bottom: calc(50% - 90px);
      display: none;
    }
    #advice,#setting{
      width: 70px;
      line-height: 70px;
      border-radius: 50%;
      text-align: center;
      background: #27bae7;
      color: #fff;
      position: fixed;
      bottom: 30px;
    }
    #advice{
      left: 10px;
      z-index: 11;
    }
    #setting{
      right: 10px;
    }
    @media screen and (max-width: 600px){
    #setting{
      left: 10px;
      bottom: 110px;
    }
    }
  </style>
</head>
<body>
  <div id="unit">
    <p>Unit 1</p>
    <p>Unit 2</p>
    <p>Unit 3</p>
    <p>Unit 4</p>
    <p>Unit 5</p>
    <p>Unit 6</p>
    <p>Unit 7</p>
    <p>Unit 8</p>
  </div>
  <div id="progress"><div id="progressInner"></div></div>
  <input id="word">
  <div id="meaning"></div>
  <div id="next"></div>
  <div id="isTrue">✔</div>
  <div id="advice">⚠报错</div>
  <div id="setting">⚙菜单</div>
  <script type="module">
    import {createClient} from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';
    var SupabaseUrl = "https://co2231a5g6hfi0gtjmd0.baseapi.memfiredb.com";
    var SupabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImV4cCI6MzI4ODM0Njc1NywiaWF0IjoxNzExNTQ2NzU3LCJpc3MiOiJzdXBhYmFzZSJ9.iee2MqZMWv-d3mRWC0YPdaganE9y58EEcw3xEh4aNk8";
    const supabase = createClient(SupabaseUrl, SupabaseKey);
    
    var meaning = [
      ["阵雨；淋浴 ","雷雨；雷暴","雷（声）","日出","日落","升起；上升；增加","（日/月）落沉；放置；设置","精确的；准确的","（两者）都不","也不；也没","靴，靴子","茉莉","花朵；开花","阳光","太极","秋千；打秋千；摇摆","融化","小丘；山坡","风；气流","温柔地；轻轻地","正发芽的","几乎；差不多；将近","毫米；千分之一米","丰富；大量","在任何时候；随便什么时候","照顾婴儿；当临时保姆","黛比（女）","栏；门栓；（酒）吧","代替；更换","推；按下","（英式）足球","将；会","兔子","低的；浅的","低于；在……下面","零","直到……为止","土拨鼠"," 灌木"],
      ["洞 ","大的；巨大的","根","幼苗；秧苗","覆盖；盖子","装满；充满","泥土；污物","堆积；压实；装（箱）","沙尘；沙土；尘土；灰尘","暴风雨","不干净的；肮脏的","北方的；北部的","底部；下方的；最下部","使人愉快的","阴影；树荫；阴凉处","达到；执行","基本的；基础的","土；土壤","频道","园艺家；园丁；花匠","登录；记录","仔细考虑；认为","阳光；日光","测试；考查","混合肥料","干的；使干；使变干","在附近；不远","松鼠","栅栏；篱笆；围墙","目的；目标；意图","白鹭","东方的；东部的","害羞的","紧紧地；牢固地","化石","西南（的）","活着的","农业；农学","种子","盆；壶；瓶","发芽","茎；干","芽；苞；花蕾；发芽","仔细地；小心翼翼地"," 院子；场地"],
      ["惊吓 ","门铃","尖叫","微小的","长沙发","假期；休假","温和的","忠诚的","跳鼠","老鼠；鼠标","（laid/laid）放置；产卵","茄子","（shook/shaken）摇动；抖动","鼓翼而飞；（使某物）拍打","避开；躲避","危险；风险","危险的","主要地；首要地","竹子","长颈鹿","逃脱；逃走","凶猛的；凶狠的","保护","愚人","世纪","（兽类的）毛","标志；象征","勇气；胆量","勇敢的；无畏的","链子；链条","平衡；平稳","原因；动机；理由","消失；失踪","杀死","砍；切；剪；割","v.使......变小；减少","n.友情；友谊","n.犀牛","n.皮；皮肤","v.警告；提醒","n.昆虫","n.关系；关联","v.生存；存活","n.老人；受尊敬的人","n.河马","n.龟","adv.真正；正确地"," n.分界线；边界"],
      ["技术 ","（电脑）桌面；台式电脑","平板电脑；牌；碑","键盘","话题","邀请","工业；企业；行业","笔记本电脑","进入；输入","关键；钥匙；按键","搜索","话题","依靠；取决于","兔子","隐藏；躲避；躲藏","印刷机；新闻界","出现；呈现；来到","现代的；新式的","电子的","卖；出售","收到；接到","癌症","祝福；保佑；赞美","金字塔","埃及","优势；有利条件；有利因素","缺点；不利因素","简单的；简明的","硬币","造成；引起","（little的比较级）更少的（地）；更小的（地）;较少量；较小的部分","除……之外；在旁边","袭击；攻击；损害","网络；网","偷盗；窃取","银行业","正确地"," 搜索；查找"],
      ["（paid/paid）支付；付（款） ","烘；烤","（美/加/澳）元","十六","广告活动；广告业；做广告","招贴；海报","便宜的；廉价的","v.挣；赚下；赢得","n.口袋；袋子;","领带；系/栓/绑","当……时候；在……期间","买得起；（有时间）做；能做","分","每天的；日常的","梯子","位置；方位","祝贺","包括；包含","账目","丈夫","大门","感激；感谢","诚实；老实；正直","信任的","坦白的；诚实的","价值","座右铭；格言；箴言","相信；依赖","战斗；战役","创作；创造","广告","顾客；主顾；客户","已经","相像的；相仿的；类似的","样品；样本","提供；供给","发光；反射","质量；品质","当然；确信无疑","成功；做成","疯狂的；荒唐的"," 面包（糕饼）师傅;面包店老板"],
      ["冠军","亲戚；亲属","厚的","照片","举起；抬起；电梯","有……重；重","（=kilogram）千克","三个以上；一些","（=before Christ）公元前","运动员","竞争;比赛","奥林匹亚（地名）","已婚的","主办；主持（活动）；主人","惊奇的；惊讶的","奥林匹克运动会的","精神；精灵","代表；象征","洲；大陆","美国；美洲","火炬；火把","和平","口号；标语","显示；表明；表达；反映","吉祥物","特征；特点","公平合理地；公正地","战胜；打败","金；黄金制品；金色（的）","奖牌；勋章","影响；作用","巴西","跳水","羽毛球","教练；辅导老师","绳","仰卧起坐","俯卧撑","赛跑；速度竞赛","结果；成绩","一个也没有；毫无","第二十（的）"],
      ["人口","到国外；在国外","日本","日语（的）；日本人（的）","南极洲","岛；岛屿","太平洋（的）","行星","十亿；千兆","总计；总数；总的；总计的","增加；增大","表面；表层","印度（的）；印度人（的）","大西洋（的）","北极的","不列颠（的）；英国人（的); 英国英语（的）","盥洗室","浴室；盥洗室","（spelled / spelled或spelt / spelt）拼写","发音；读法","语法","翻译","美国（的）； 美国人（的）","澳大利亚人（的）","发音；读法","欢迎；迎接","欧洲；欧洲人（的）","吻","脸颊；脸蛋","点头","翘拇指；很棒","有礼貌的","嘴唇","粗鲁的；粗野的","意大利人（语）；意大利人（的）","准备；预备","（热带）雨林","土耳其","引以自豪的事物或人；骄傲","百万","平方；广场；正方形"],
      ["校园","注意；留心","垃圾；废物","垃圾","污染","解释","减少","可重复利用的","（little的最高级） adj & adv 最少的（地）；最小的（地）;最少量；最小物","污染；弄脏","跳跃；跳绳","包装","渗漏的","浪费","公升","水槽水；池","电","关上；合上","v. 分类；整理; n. 类；种类；类型","把……弄空；空的","金属","塑料（的）","回收再用；再循环","量；数量","n. 垃圾；v.使乱七八糟；乱扔","渗漏","龙头；阀门","啤酒","货车；手推车","回收利用","工厂","不像；与……不同","蜜蜂","蚂蚁","鸽子","（died / died）（现在分词为dying）死亡","死的","物种；种类","尊敬；尊重","用过的；旧的；二手的","分开；分割","堆；大量","座位","盖子","吨","责任；义务"]
    ];
    var word = [
      ["shower","thunderstorm","thunder","sunrise","sunset","rise","set","exact","neither","nor","boot","jasmine","blossom","sunshine","TaiChi","swing","melt","hillside","wind","gently","budding","nearly","millimeter","plenty","anytime","babysit","Debbie","bar","instead","push","soccer","shall","rabbit","low","below","zero","until","groundhog","bush"],
      ["hole","large","root","seedling","cover","fill","dirt","pack","dust","storm","dirty","northern","bottom","pleasant","shade","fulfil","basic","soil","channel","gardener","log","consider","sunlight","test","compost","dry","nearby","squirrel","fence","purpose","egret","eastern","shy","tightly","fossil","southwest","living","agriculture","seed","pot","sprout","stem","bud","carefully","yard"],
      ["scare","doorbell","scream","tiny","sofa","vacation","gentle","loyal","jerboa","mouse","lay","eggplant","shake","flap","avoid","danger","dangerous","mainly","bamboo","giraffe","escape","fierce","protect","fool","century","fur","symbol","courage","brave","chain","balance","reason","disappear","kill","cut","decrease","friendship","rhino","skin","warn","insect","relationship","survive","mzee","hippo","tortoise","truly","boundary"],
      ["technology","desktop","tablet","keyboard","topic","invitation","industry","laptop","enter","key","search","topic","depend","bunny","hide","press","appear","modern","electronic","sell","receive","cancer","blessing","pyramid","Egypt","advantage","disadvantage","simple","coin","cause","less","aside","attack","web","steal","banking","properly","search"],
      ["pay","bake","dollar","sixteen","advertising","poster","cheap","pocket","tie","while","afford","cent","everyday","ladder","position","congratulate","including","account","husband","gate","appreciate","honesty","trusting","honest","value","motto","trust","battle","create","ad","customer","already","similar","sample","offer","shine","quality","surely","succeed","crazy","baker"],
      ["champion","relative","thick","photograph","lift","weigh","kilo（=kilogram）","several","BC","athlete","compete","Olympia","married","host","amazed","Olympic","spirit","represent","continent","America","torch","peace","slogan","reflect","mascot","feature","fairly","defeat","gold","medal","influence","Brazil","diving","badminton","coach","rope","sit-up","push-up","race","result","none","twentieth"],
      ["population","abroad","Japan","Japanese","Antarctica","island","Pacific","planet","billion","total","increase","surface","Indian","Atlantic","Arctic","British","washroom","bathroom","spell","pronunciation","grammar","translate","American","Australian","pronounce","greet","European","kiss","cheek","nod","thumbs-up","polite","lip","rude","Italian","prepare","rainforest","Turkey","pride","million","square"],
      ["schoolyard","attention","rubbish","garbage","pollution","explain","reduce","reusable","least","pollute","skip","packaging","leaky","waste","litre","sink","electricity","shut","sort","empty","metal","plastic","recycle","amount","litter","leak","tap","beer","truck","recycling","factory","unlike","bee","ant","dove","die","dead","species","respect","used","divide","pile","seat","lid","ton","duty"]
    ];
    var n = [0,0];
    var isTrue = true;
    var meaning_E = document.getElementById("meaning");
    var word_E = document.getElementById("word");
    var next_E = document.getElementById("next");
    var isTrue_E = document.getElementById("isTrue");
    var progressInner_E = document.getElementById("progressInner");
    
    document.getElementById("unit").onclick = function(){
      var child = event.target.innerHTML;
      var u = child.substr(-1);
      if(u==0){return;}
      n = [(u-1),0];
      fill();
      this.style.display = "none";
    }
    
    function fill(){
      if(!isTrue){
        return;
      }else if(n[0] == meaning.length && n[1] == meaning[n[0]].length){
        return;
      }
      progressInner_E.innerHTML = (n[1]+1)+"/"+meaning[n[0]].length;
      progressInner_E.style.width = (n[1]+1)/meaning[n[0]].length*100+"%";
      meaning_E.innerHTML = meaning[n[0]][n[1]];
      word_E.value = "";
      isTrue = false;
      isTrue_E.style.display = "none";
      next_E.style.display = "none";
      n[1]++;
    }
    
    next_E.addEventListener("click", fill);
    document.body.addEventListener("keydown", function(){
      if(event.key == "Enter"){fill();}
    })
    word_E.addEventListener("keyup", function(){
      if(this.value == word[n[0]][n[1]-1]){
        isTrue = true;
        isTrue_E.style.display = (isTrue) ? "block":"none";
        next_E.style.display = (isTrue) ? "block":"none";
      }
    })
    
    var cookies = decodeURI(document.cookie).split("; ");
    function getUserName(){
      for(var t=cookies.length;t--;t>0){
        if(cookies[t].indexOf("user_name")!=-1){var name = cookies[t].split("=")[1];}
      }
      var notNull = /[^ ]/g;
      if(name==""||name==null||!notNull.test(name)||name=="null"){
        var name = prompt("Please enter your user name","guest"+Math.floor(Math.random()*5000));
        var date = new Date();
        date.setTime(date.getTime()+(365*24*3600000));
        var expires="expires="+date.toGMTString()+";";
        var content="user_name="+name+";";
        document.cookie=content+expires+"path=/";
      }
      return name;
    }
    document.getElementById("advice").onclick = async function(){
      var advice = prompt("");
      var sender = getUserName();
      if(sender==null){return;}
      var time = new Date().getTime();
      var { error } = await supabase.from('advice').insert({s:sender, a:advice, t:time});
    }
    document.getElementById("setting").onclick = function(){
      this.style.display = "block";
    }
  </script>
</body>
</html>
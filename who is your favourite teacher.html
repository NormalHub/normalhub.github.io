<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>è°æ˜¯ä½ æœ€å–œæ¬¢çš„è€å¸ˆ</title>
<link rel="icon" href="./imgs/xie.png">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0, user-scalable=0">
<link rel="stylesheet" type="text/css" href="./css/index-PC.css"/>
<style>body{display:block;text-align:center;}.like,.dislike{float:left;width:calc(50% - 20px);height:calc(100% - 50px);padding: 5px;border: 1px solid #000;margin: 0 4px;}.like p,.dislike p{width: calc(100% - 35px);margin: 5px 5px 0 0;font-size: 24px;color: #fff;background: #9bd0ff;display: inline-block;}.like h2,.dislike h2{display: inline-block;width: 30px;background: #9bd0ff;color: #fff;margin: 0;}.like div,.dislike div{width:100%;margin:5px 0;background: #fff;display: flex;}.like span,.dislike span{flex: 1;padding: 5px;}span:nth-child(1),span:nth-child(3){background: #eee;}.like span:nth-child(2):before{content: "â¤";color: red;}.dislike span:nth-child(2):before{content: "ğŸ’”ï¸";}@media screen and (max-width: 600px){.like,.dislike{margin: 0;border:none;min-height:40%;width:100%;padding: 0;}}</style>
</head>
<body>
<div class="toubulan"><a class="tbl" href="./index.html">é¦–é¡µ</a><input class="sousuokuang" id="searchInput"/><div class="tbl" id="search">æœç´¢</div></div><h2>è°æ˜¯ä½ æœ€å–œæ¬¢/è®¨åŒçš„è€å¸ˆï¼Ÿ</h2><div class="like"><p>like</p><h2 name="creat">+</h2></div><div class="dislike"><p>dislike</p><h2 name="creat">+</h2></div>
<div style="width: 100%;" id="ending"></div>
<script type="module">
import {createClient} from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';
var SupabaseUrl="https://co2231a5g6hfi0gtjmd0.baseapi.memfiredb.com";
var SupabaseKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImV4cCI6MzI4ODM0Njc1NywiaWF0IjoxNzExNTQ2NzU3LCJpc3MiOiJzdXBhYmFzZSJ9.iee2MqZMWv-d3mRWC0YPdaganE9y58EEcw3xEh4aNk8";
const supabase=createClient(SupabaseUrl, SupabaseKey);
var likeDiv=document.getElementsByClassName("like")[0];
var dislikeDiv=document.getElementsByClassName("dislike")[0];
var {data,error}=await supabase.from('teacherLiked').select();
var discussion=[];
(function(){for(var t=data.length;t--;t>0){var name=data[t].name;var likes=data[t].likes;discussion.push(data[t].discussion);var box=document.createElement("div");box.innerHTML="<span>"+name+"</span><span name='support'>"+likes+"</span><span name='more' id="+t+">æ›´å¤šâˆ¨</span><span name='d'>è¯„è®º</span>";if(data[t].is_liked){likeDiv.appendChild(box);}else{dislikeDiv.appendChild(box);}}}())
var support=document.getElementsByName("support");
var more=document.getElementsByName("more");
for(var x=support.length;x--;x>0){support[x].onclick=async function(){var {error}=await supabase.from('teacherLiked').update({likes: Number(this.innerHTML)+1}).eq('name',this.previousSibling.innerHTML);this.innerHTML++;};
more[x].onclick= function(){var d=discussion[discussion.length-1-Number(this.id)];if(this.innerHTML=="æ”¶èµ·âˆ§"){this.innerHTML="æ›´å¤šâˆ¨";for(var t in d){this.parentNode.nextSibling.remove();}}else{this.innerHTML="æ”¶èµ·âˆ§";for(var t in d){this.parentNode.insertAdjacentHTML("afterend","<div style='width:calc(100% - 10px);padding:5px'>"+d[t]+"</div>");}}}}
function check(v){var notNull = /[^ ]/g;if(v==""||v==null||!notNull.test(v)||v=="null"){return false;}else{return v;}}
async function creat(isLike){alert("å»ºè®®ä¸è¦ç›´æ¥å†™è€å¸ˆå§“åï¼Œè€Œæ˜¯â€œXXç­XXå­¦ç§‘è€å¸ˆâ€;è¯„è®ºè¦æ³¨æ„æ–‡æ˜ç”¨è¯­");var name=check(prompt("å“ªä¸ªè€å¸ˆï¼Ÿï¼ˆ1/2ï¼‰",""));if(!name){return;}var discuss=check(prompt("è¯„è®ºï¼ˆ2/2ï¼‰",""));if(!discuss){return;}var {error}=await supabase.from('teacherLiked').insert({name:name,discussion:{"0":discuss},is_liked:isLike});var box=document.createElement("div");box.innerHTML="<span>"+name+"</span><span name='support'>1</span><span name='more' id="+t+">æ›´å¤šâˆ¨</span><span name='d'>è¯„è®º</span>";if(isLike){likeDiv.appendChild(box);}else{dislikeDiv.appendChild(box);}}
document.getElementsByName("creat")[0].onclick=function(){creat(true);};document.getElementsByName("creat")[1].onclick=function(){creat(false);}
var dDom= document.getElementsByName("d");
for(var t=dDom.length;t--;t>0){dDom[t].onclick=async function(){alert("è¯„è®ºè¦æ³¨æ„æ–‡æ˜ç”¨è¯­");var c=check(prompt("è¯„è®º",""));if(!c){return;}var d=discussion[discussion.length-1-Number(this.previousSibling.id)];function getlength(){var l=0;for(var x in d){l++;};return l;}d[getlength()]=c;var {error}=await supabase.from('teacherLiked').update({discussion:d}).eq('name',this.parentNode.children[0].innerHTML);}}
</script>
<script>document.getElementById("ending").innerHTML="æ³¨æ„ï¼šæœ¬é¡µé¢ä¸ä¼šè®°å½•ä»»ä½•ä½¿ç”¨è€…ä¿¡æ¯ï¼Œä½ æ˜¯åŒ¿åçš„ï¼<br>æœ€åä¿®æ”¹æ—¶é—´ï¼š"+document.lastModified;</script>
</body>
</html>